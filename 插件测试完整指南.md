# 🧪 飞书插件测试完整指南

## 📋 测试准备

### 1. 数据格式要求

插件需要以下格式的数据：

```json
[
  {
    "province": "北京",      // 必需：省份名称
    "value": 150,           // 必需：数值（用于颜色映射）
    "manager": "张三",       // 可选：负责人
    "organization": "北京分公司"  // 可选：机构名称
  }
]
```

### 2. 支持的省份名称

插件支持以下省份（会自动标准化）：
- 直辖市：北京、上海、天津、重庆
- 省份：河北、山西、辽宁、吉林、黑龙江、江苏、浙江、安徽、福建、江西、山东、河南、湖北、湖南、广东、海南、四川、贵州、云南、陕西、甘肃、青海、台湾
- 自治区：内蒙古、广西、西藏、宁夏、新疆
- 特别行政区：香港、澳门

## 🔧 测试工具使用

### 方法1：使用测试脚本

```bash
# 运行完整测试
node test-plugin-integration.js

# 运行数据转换示例
node data-converter.js
```

### 方法2：自定义数据测试

```javascript
const { runTests } = require('./test-plugin-integration.js');

// 你的数据
const myData = [
  { province: '北京', value: 150, manager: '张三' },
  { province: '上海', value: 120, manager: '李四' },
  // ... 更多数据
];

// 运行测试
runTests(myData).then(results => {
  console.log('测试完成:', results);
});
```

### 方法3：转换多维表格数据

```javascript
const DataConverter = require('./data-converter.js');
const converter = new DataConverter();

// 飞书多维表格数据格式
const bitableData = [
  { 
    fields: { 
      '省份': '北京市', 
      '机构数量': 150, 
      '负责人': '张三',
      '机构名称': '北京分公司'
    } 
  }
];

// 字段映射配置
const fieldMapping = {
  provinceField: '省份',      // 省份字段名
  valueField: '机构数量',     // 数值字段名
  managerField: '负责人',     // 负责人字段名（可选）
  organizationField: '机构名称' // 机构字段名（可选）
};

// 转换数据
const result = converter.convertBitableData(bitableData, fieldMapping);
console.log('转换结果:', result);
```

## 📊 数据提供方式

### 方式1：直接提供JSON数据

```json
[
  {"province": "北京", "value": 150, "manager": "张三", "organization": "北京分公司"},
  {"province": "上海", "value": 120, "manager": "李四", "organization": "上海分公司"},
  {"province": "广东", "value": 200, "manager": "王五", "organization": "广州分公司"}
]
```

### 方式2：提供CSV格式

```csv
省份,数量,负责人,机构
北京,150,张三,北京分公司
上海,120,李四,上海分公司
广东,200,王五,广州分公司
```

### 方式3：描述多维表格结构

请提供：
1. **表格截图**或**字段列表**
2. **字段名称**：
   - 省份字段叫什么？
   - 数值字段叫什么？
   - 其他字段名称
3. **样本数据**：3-5行实际数据

## 🎯 测试检查项

### ✅ 数据格式检查
- [ ] 数据是数组格式
- [ ] 包含必需字段：province, value
- [ ] 省份名称有效
- [ ] 数值为有效数字

### ✅ 地区映射检查
- [ ] 省份名称能正确映射到标准名称
- [ ] 支持带后缀的省份名（如"北京市"→"北京"）
- [ ] 处理特殊地区名称

### ✅ 可视化检查
- [ ] 颜色方案正常工作
- [ ] 数值范围合理分布
- [ ] 地图渲染正确

### ✅ 性能检查
- [ ] 数据处理速度acceptable
- [ ] 内存使用合理
- [ ] 响应时间 < 1秒

## 🚀 快速测试步骤

### 第1步：准备数据
按照上述格式准备你的数据

### 第2步：运行测试
```bash
cd feishu-china-map-dashboard
node test-plugin-integration.js
```

### 第3步：查看结果
检查测试输出中的：
- ✅ 数据格式验证
- 🗺️ 地区映射结果
- 🎨 颜色方案效果
- ⚡ 性能指标

### 第4步：修正问题
根据测试结果修正数据格式或字段映射

## 📞 需要提供的信息

为了帮你完成测试，请提供：

1. **多维表格信息**
   - 表格名称
   - 字段列表
   - 数据类型说明

2. **样本数据**
   - 3-5行实际数据
   - CSV格式或JSON格式

3. **特殊需求**
   - 颜色方案偏好
   - 特殊地区处理需求
   - 数值单位说明

## 🎉 测试完成后

测试通过后，你可以：
1. 使用GitHub仓库直接部署到飞书
2. 下载插件ZIP包上传到飞书
3. 在飞书中配置数据源和显示选项

插件将自动：
- 连接你的多维表格
- 处理数据格式转换
- 生成交互式中国地图
- 根据数值显示颜色深浅
- 提供详细的数据展示

---

**准备好了吗？请提供你的多维表格数据，我们开始测试！** 🚀