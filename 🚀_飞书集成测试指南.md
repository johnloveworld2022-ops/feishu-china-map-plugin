# 🚀 飞书多维表格集成测试指南

## 🎯 快速开始

### 方式一：一键启动 (推荐)
```bash
./start-test.sh
```

### 方式二：配置向导
```bash
node setup-wizard.js
```

### 方式三：手动配置
```bash
# 1. 复制配置模板
cp test-config.example.js test-config.js

# 2. 编辑配置文件
# 填入你的 appToken, tableId 等信息

# 3. 运行测试
node run-feishu-test.js
```

## 📋 需要准备的信息

### 🔑 必需信息
1. **App Token** - 应用令牌
   - 获取位置：飞书开发者后台 → 应用管理 → 凭证与基础信息
   - 格式：`app_xxxxxxxxxxxxxxxxx`

2. **Table ID** - 表格ID
   - 获取位置：多维表格URL中的table参数
   - 格式：`tblxxxxxxxxxxxxxxxxx`
   - 示例URL：`https://xxx.feishu.cn/base/xxxxx?table=tblxxxxxxxxx`

### 📊 字段信息
3. **省份字段名** - 你的表格中省份列的名称
   - 示例：`省份`、`地区`、`region`

4. **数值字段名** - 用于地图颜色标记的数值列
   - 示例：`数量`、`金额`、`count`

5. **其他字段** (可选)
   - 负责人字段：`负责人`、`manager`
   - 机构字段：`机构`、`organization`

## 🔧 详细步骤

### 第1步：获取App Token
1. 登录 [飞书开发者后台](https://open.feishu.cn/)
2. 进入"应用管理"
3. 选择你的应用（没有则需要创建）
4. 在"凭证与基础信息"页面复制"App Token"

### 第2步：获取Table ID
1. 打开你的多维表格
2. 从浏览器地址栏复制URL
3. 提取URL中`table=`后面的值
4. 格式：`tblxxxxxxxxxxxxxxxxx`

### 第3步：确认权限
确保你的应用有以下权限：
- ✅ `bitable:app` - 多维表格应用权限
- ✅ `bitable:app:readonly` - 只读权限

### 第4步：运行测试
```bash
# 使用一键启动脚本
./start-test.sh

# 或者直接运行配置向导
node setup-wizard.js
```

## 📊 测试内容

测试工具会自动检查：

### ✅ API连接测试
- 验证App Token有效性
- 检查Table ID正确性
- 测试权限配置

### ✅ 数据结构分析
- 自动识别字段类型
- 建议最佳字段映射
- 分析数据质量

### ✅ 数据转换测试
- 省份名称标准化
- 数值格式验证
- 数据完整性检查

### ✅ 插件兼容性测试
- 地图渲染测试
- 颜色方案测试
- 性能基准测试

## 📄 测试报告

测试完成后会生成详细报告：
- `feishu-test-report.md` - 完整测试报告
- 包含数据分析、转换结果、兼容性评估

## 🎉 测试成功后

如果测试通过，你可以：

1. **直接部署插件**
   - 使用GitHub仓库：https://github.com/johnloveworld2022-ops/feishu-china-map-plugin
   - 或上传插件ZIP包

2. **配置插件**
   - 选择数据源：飞书多维表格
   - 设置字段映射
   - 选择颜色方案

3. **开始使用**
   - 插件会自动连接你的表格
   - 实时显示数据变化
   - 提供交互式地图体验

## 🔧 故障排除

### 常见问题

**Q: API调用失败**
- 检查App Token是否正确
- 确认应用权限配置
- 验证网络连接

**Q: 找不到表格**
- 检查Table ID是否正确
- 确认表格访问权限
- 验证表格是否存在

**Q: 数据转换失败**
- 检查字段名称是否匹配
- 确认数据格式正确
- 查看详细错误信息

**Q: 省份映射失败**
- 检查省份名称格式
- 使用标准省份名称
- 查看映射建议

## 📞 获取帮助

如果遇到问题：
1. 查看测试报告中的详细错误信息
2. 检查 `飞书多维表格接入信息收集.md`
3. 确认配置信息正确性

## 🎯 配置示例

```javascript
// test-config.js 示例
const feishuConfig = {
  appToken: 'app_xxxxxxxxxxxxxxxxx',
  tableId: 'tblxxxxxxxxxxxxxxxxx'
};

const fieldMapping = {
  provinceField: '省份',
  valueField: '数量',
  managerField: '负责人',
  organizationField: '机构'
};
```

---

**准备好了吗？运行 `./start-test.sh` 开始测试！** 🚀